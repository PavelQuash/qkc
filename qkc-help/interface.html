<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>qshKeyCommander1 - Интефейс программы</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<META NAME="Author" CONTENT="<Quash!> aka Павел Х">
<META NAME="Keywords" CONTENT="quash, qshKeyCommander">
<STYLE>
A:LINK   {COLOR:#0000FF; TEXT-DECORATION:NONE;}
A:VISITED{COLOR:#0000FF; TEXT-DECORATION:NONE;}
A:HOVER  {COLOR:#FF0000; TEXT-DECORATION:UNDERLINE;}
</STYLE>
</HEAD>

<BODY>

<TABLE cellSpacing=0 cellPadding=0 width="80%" border=0 ALIGN=center>
<TR><TD STYLE="text-align:justify"><FONT SIZE=2 FACE="verdana">

<H4>Интефейс программы</H4>
Интерфейс программы интуитивно понятен и состоит из следующих окон, в которых можно узнать какую-либо информацию, либо произвести настройку параметров программы, также будет уделено внимание некоторым особенностям работы с ними. Прокомментирую их кратко:
<OL>
	<LI><A HREF="#mainmenu"    >Главное меню</A>
	<LI><A HREF="#about"       >О программе...</A>
	<LI><A HREF="#help"        >Справка</A>
	<LI><A HREF="#menusettings">Меню настроек программы</A>
	<LI><A HREF="#kbrd"        >Настройка клавиш клавиатуры</A>
	<br>- <A HREF="#kbrd-enterhotkey" >Ввод горячей клавиши</A>
    <LI><A HREF="#wirc"        >Настройка кнопок WinLIRC</A>
	<br>- <A HREF="#wirc-enterrepeats">Ввод количества повторений</A>
	<LI><A HREF="#pluginslist" >Подключение модулей</A>
	<LI><A HREF="#config"      >Настройки программы</A>
</OL>


<CENTER>
<A name="mainmenu"><H4>Главное меню</H4></A>
<IMG SRC="qkc_wnd_mainmenu.jpg" WIDTH="237" HEIGHT="219" BORDER=0 ALT="Главное меню">
</CENTER>
Из главного меню программы осуществляется переход к настройке программы.
<br><br>
Можно вызвать справку как по самой программе, так и по установленным модулям.
<br><br>
Также из данного меню можно вызвать диалог, отображающий информацию о программе.
<br><br>
Спрятать окно можно нажатием соответствующей кнопки. В данном случае, если нажать на X в заголовке окна или комбинацию клавиш Alt+F4, закрывающую окно, то оно будет просто спрятано и программа продолжит свою работу.
<br><br>
Для того, чтобы завершить работу пограммы, следует нажать "Закончить работу". Завершить работу программы можно и по Ctrl+Alt+Del, она этому не противится, но все данные будут утеряны, не успев сохраниться.
<br><br>
<i>Быстрые клавиши:</i><br>
Подчёркнутые символные клавиши - выбор элемента меню<br>


<CENTER>
<A name="about"><H4>О программе...</H4></A>
<IMG SRC="qkc_wnd_about.jpg" WIDTH="320" HEIGHT="218" BORDER=0 ALT="О программе">
</CENTER>
Данный диалог является стандартным. В нём можно получить информацию о текущей программе: её название, версию, статус, домашнюю страничку, информацию о связи с автором и информацию об авторе и версии перевода.


<CENTER>
<A name="help"><H4>Справка</H4></A>
<IMG SRC="qkc_wnd_help.jpg" WIDTH="315" HEIGHT="289" BORDER=0 ALT="Диалог помощи">
</CENTER>
При выводе диалога перед пользователем возникает список найденных файлов помощи. Файлы могут быть следующих типов: txt, nfo, htm, html, doc, hlp, url. Выбор файла осуществляется с помощью клавиш Вверх и Вниз, а вывод помощи - по клавише Ввод. После этого документ будет развёрнут на весь экран для изучения пользователем.
<br><br>
<i>Быстрые клавиши:</i><br>
Стрелки вверх и вниз - выбор элемента в списке<br>
Ввод - вывод выбранной справки<br>


<CENTER>
<A name="menusettings"><H4>Меню настроек программы</H4></A>
<IMG SRC="qkc_wnd_settings_menu.jpg" WIDTH="143" HEIGHT="405" BORDER=0 ALT="Меню настроек">
</CENTER>
Перед вами меню настроек программы. Как видите оно разделено на две части, первая из которых относится к подключаемым модулям и их настройке, а вторая - к конфигурации самой программы.
<br><br>
<i>Быстрые клавиши:</i><br>
Подчёркнутые символные клавиши - выбор элемента меню<br>


<CENTER>
<A name="kbrd"><H4>Настройка клавиш клавиатуры</H4></A>
<IMG SRC="qkc_wnd_settings_1.kbrd.jpg" WIDTH="460" HEIGHT="356" BORDER=0 ALT="Настройка клавиш клавиатуры">
</CENTER>
Для включения отслеживания сообщений от клавиатуры следует установить галочку в правом-верхнем углу диалога. В левом списке отображаются активные модули, а в правом - находятся команды выбранного модуля и соответствующие им комбинации клавиш с состояниями клавиш Caps Lock, Num Lock и Scroll Lock при которых команда будет срабатывать.
<br><br>
Например, если в состоянии CNS стоит "[c+n-]", то это значит, что команда сработает при нажатии данной комбинации клавиш, причём Caps Lock должна быть во включенном состоянии, а Num Lock - в выключенном. При других состояниях действие выполняться не будет. Если CNS стоит в состоянии "[]", то действие будет выполняться в любом случае, независимо от состояний клавиш Caps Lock, Num Lock и Scroll Lock.
<br><br>
Для установки комбинации клавиш команде следует нажать кнопку "Изменить", будет выведен диалог ввода. 
<br><br>
<i>Быстрые клавиши (активные модули):</i><br>
Стрелки вверх и вниз или ЛКМ - выбор элемента<br>
<br>
<i>Быстрые клавиши (список команд модуля):</i><br>
Стрелки вверх и вниз или ЛКМ - выбор элемента<br>
Insert или Двойное нажатие ЛКМ - изменить клавишу и состояния CNS<br>
Delete или ПКМ - очистить команду<br>

<CENTER>
<A name="kbrd-enterhotkey"><H4>Настройка клавиш клавиатуры - Ввод горячей клавиши</H4></A>
<IMG SRC="qkc_wnd_settings_1.enterhotkey.jpg" WIDTH="300" HEIGHT="125" BORDER=0 ALT="Ввод горячей клавиши">
</CENTER>
После того, когда вы нажмёте на кнопку "Изменить", перед вами будет выведен диалог ввода комбинации клавиш. При выводе диалога старое значение клавиши стирается и при закрытии диалога клавиша будет либо очищена, либо установлена новая комбинация.
<br><br>
При отслеживании клавиш клавиатуры могут быть учтены состояния клавиш Caps Lock, Num Lock и Scroll Lock в любой комбинации, определённой пользователем.
<br><br>
Условием на ввод горячей клавиши, является то, что вводимые комбинации должны быть вида [модификатор(ы)] + клавиша_не_модификатор (исключается, например, A + Z).
<br><br>
Так как в системе могут быть установлены горячие клавиши, которые перехватывают сообщения, предназначенные окну, то ввод осуществляется поочерёдным нажатием клавиш (не всех сразу): сначала клавиши-модификаторы или выставляются состояния клавиш CNS (Caps Lock, Num Lock, Scroll Lock), а в последнюю очередь нажимается клавиша-не-модификатор (символьные - не CNS и не модификаторы).
<br><br>
При вводе клавиши-не-модификатора диалог закрывается и выбранному действию присваивается новое значение горячей клавиши.
<br><br>
<i>Быстрые клавиши:</i><br>
Alt+F4 - закрытие окна, выбранному действию ничего не соответствует<br>


<CENTER>
<A name="wirc"><H4>Настройка кнопок WinLIRC</H4></A>
<IMG SRC="qkc_wnd_settings_2.wirc.jpg" WIDTH="460" HEIGHT="356" BORDER=0 ALT="Настройка кнопок WinLIRC">
</CENTER>
Для включения отслеживания сообщений от ПДУ следует установить галочку в правом-верхнем углу диалога. В левом списке отображаются активные модули, а в правом - находятся команды выбранного модуля и соответствующие им кнопки ПДУ с количеством повторов нажатий кнопки для срабатывания команды.
<br><br>
Если вы спаяли схему и сделали все настройки в WinLIRC правильно, то программа с лёгкостью сможет подключиться к серверу WinLIRC. Для установки соответствия кнопки команде плагина следует выбрать эту команду и нажать кнопку ПДУ. В поле кнопка отобразится имя нажатой кнопки, а поле "N" (количество повторов) установится в значение (-1).<br>
- Если необходимо сделать так, чтобы кнопка сработала один раз, то следует поставить 0 повторов.<br>
- Если нужно сделать срабатывание кнопки через некоторое время, то можно поставить, например, 20 повторов, тогда она сработает примерно через 5-10 секунд (в зависимости от многих факторов: фотоприёмник, программа и так далее). Величина для конкретного промежутка времени определяется экспериментально.<br>
<br>
<i>Быстрые клавиши (активные модули):</i><br>
Стрелки вверх и вниз или ЛКМ - выбор элемента<br>
<br>
<i>Быстрые клавиши (список команд модуля):</i><br>
Стрелки вверх и вниз или ЛКМ - выбор элемента<br>
Insert или Двойное нажатие ЛКМ - изменить количество повторений<br>
Delete или ПКМ - очистить команду<br>

<CENTER>
<A name="wirc-enterrepeats"><H4>Настройка кнопок WinLIRC - Ввод количества повторений</H4></A>
<IMG SRC="qkc_wnd_settings_2.enterrepeats.jpg" WIDTH="230" HEIGHT="71" BORDER=0 ALT="Ввод количества повторений">
</CENTER>
При отслеживании кнопок ПДУ, можно установить либо одиночное, либо многоразовое нажатие, либо сделать задержку с помощью данного диалога.
<br><br>
Можно устанавливать следующие значения<br>
(-1) или меньше нуля - кнопка будет срабатывать множество раз, пока удерживается<br>
0 - кнопка сработает только один раз при одиночном нажатии, при удерживании ничего происходить не будет<br>
больше нуля - количество повторений нажатия кнопки (при удержании) для срабатывания команды один раз<br>
<br>
По умолчанию это значение выставляется в (-1).<br>
<br>
<i>Быстрые клавиши:</i><br>
Ввод - принять введённое значение<br>

<CENTER>
<A name="pluginslist"><H4>Подключение модулей</H4></A>
<IMG SRC="qkc_wnd_settings_3.pluginslist.jpg" WIDTH="460" HEIGHT="356" BORDER=0 ALT="Подключение модулей">
</CENTER>
Если вы скачали новый плагин с домашней странички программы в zip-файле, то для установки следует просто разархивировать его в каталог программы с заменой всех файлов (если была установлена старая версия плагина), если у плагина есть инсталлятор, то он сделает всю работу за вас. Затем активировать плагин с помощью данного диалога.
<br><br>
При выводе диалога обнаруженные плагины должны появиться в левом списке "Найденные модули". Справа отображаются "Активные модули" в данный момент.
<br><br>
Если вы хотите подключить модуль к программе или просто получить о нём информацию, то его следует сделать активным - отметить этот плагин и нажать кнопку "Добавить", тогда плагин появится в списке активных модулей. Аналогично используется кнопка "Исключить".
<br><br>
Если вы хотите добавить в список все модули сразу, то следует нажать "Добавить все", а если удалить, то "Исключить все".
<br><br>
Вышеупомянутые действия не загружают модули в память при добавлении и не выгружают - при исключении. Это этап планирования - предварительного распределения модулей. Для подтверждения произведённых действий следует нажать кнопку "Применить".
<br><br>
Обновить списки можно с помощью соответствующей команды.


<CENTER>
<A name="config"><H4>Настройки программы</H4></A>
<IMG SRC="qkc_wnd_settings_4.config.jpg" WIDTH="460" HEIGHT="356" BORDER=0 ALT="Настройки программы">
</CENTER>
Для отслеживания сообщений от клавиатуры используется два способа - RegisterHotKey и WinHooks.
<br><br>
RegisterHotKey - метод используется, если пользователь работает на компьютере в различных офисных приложениях; он ставит в систему горячие клавиши, соответствующие определённым командам.
<br><br>
WinHooks - данный метод намного мощнее, чем предыдущий (требуется qshKeyCommanderHooks.dll); прежде всего он подходит для тех, кто играет в игры (Counter Strike, Half-Life, WinQuake, Quake3 и другие win-приложения; для Quake2 можно использовать и RegisterHotKey - проверено :)) и параллельно при этом хочет выполнять какие-либо действия, например, управлять Winamp'ом.
<br><br>
Скрыть программу от Task Manager'а можно только в Win9x, в остальных NT-вых системах её можно с лёгкостью обнаружить.
<br><br>
Переключение раскладки клавиатуры, при старте программы, предназначено для того, чтобы облегчить пользователю жизнь. Например, если у пользователя стоит по умолчанию русская раскладка, а у самой программы (её диалоги) или её плагина (например, меню) английский интерфейс, то нажав при русской раскладке символьную клавишу, выбора не осуществится, а при переключенной, наоборот - всё будет работать. Символ выбора - это подчёркнутые символы 1,2,3 и так далее, которыми вы пользуетесь/должны пользоваться :) для быстрого перемещения по настройкам программы.
<br><br>
Для индикации нахождения программы в памяти можно использовать вывод её иконки в трэе (около системных часов). Также с помощью иконки трэя можно получить доступ к главному меню программы (левая клавиша мыши, если действие разрешено) или вывести диалог "О программе..." (правая клавиша мыши).
<br><br>
Функция стирания одинаковых клавиш после ввода служит для того, чтобы избежать повторения клавиш или кнопок. Она осуществляется следующим образом: при вводе клавиши или кнопки проверяется, не связана ли она уже с каким-либо действием, если данная опция включена и клавиша/кнопка уже существует, то новые данные принимаются, а все повторные - стираются, при выключенной опции ничего не происходит и пользователь должен сам отслеживать все повторения.
<br><br>
Программа может прописать себя в автозагрузку - при старте Windows (HKEY_LOCAL_MACHINE, "Software\Microsoft\Windows\CurrentVersion\Run" ключ "qshKeyCommander"), а также может и удалить себя из автозагрузки.
<br><br>
Установка языка:<br>
Если вы не русский, то наверное вас напрягает интерфейс программы, в диалогах которой находятся непонятные "кракозябы". Но, к счастью, это можно исправить - не удалять же программу! :) Для исправления этого необходимо выбрать необходимый язык из уже установленных, если его нет, то можно зайти на сайт программы. Уж там, хоть английский (English), но найдётся. Итак, если язык уже скачан, а вы так и не знаете что с ним делать, то следует поступить следующим образом: разархивировать zip-файл языка в корневой каталог программы c заменой файлов, а затем перейти к данному диалогу. Переключение на другой язык не требует перезагрузки программы, нужно всего лишь закрыть все диалоги и снова открыть.
<br><br>
Теперь разберёмся с доступом к главному меню программы. Способов доступа существует 4 вида:<br>
По трэю - разрешение получать доступ при нажатии левой клавишей мыши по иконке трэя;<br>
По комбинации клавиш - доступ по горячей клавише с помощью метода RegisterHotKey (без WinHooks);<br>
По паролю - пароль просто набирается в любом win-приложении (требуется qshKeyCommanderHooks.dll);<br>
По двойному запуску - программа выводит главное меню при повторном запуске программы;


</FONT></TD></TR>
</TABLE>

</BODY>
</HTML>